<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="-" />
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/z799gs/550o8@main/style.css"/>
<style>
    canvas:focus { outline: none; }
    html, body {
        padding: 0; margin: 0; overflow: hidden;
        width: 100%; height: 100%;
        background-color: #000;
    }
    #unity-container { 
        width: 100%; height: 100%; 
        position: absolute; top: 0; left: 0; 
    }
    #unity-canvas { 
        width: 100% !important; height: 100% !important; 
    }
</style>
</head>
<body class="dark">
<div id="unity-container" class="unity-desktop">
    <canvas id="unity-canvas" tabindex="-1"></canvas>
</div>
<div id="loading-cover" style="display:none;">
    <div id="unity-loading-bar">
        <div id="unity-progress-bar-empty" style="display: none;">
            <div id="unity-progress-bar-full"></div>
        </div>
        <div class="spinner"></div>
    </div>
</div>

<script>
    // --- 1. GLOBAL DEĞİŞKENLER (UNITY'NİN ARADIĞI KRİTİK ALANLAR) ---
    const NO_DATA = 'no data';
    
    // Unity C# tarafı bu değişkenleri doğrudan window'da arar
    var environmentData = NO_DATA;
    var cloudSaves = NO_DATA;
    var playerData = NO_DATA;
    var paymentsData = NO_DATA;
    var statsSaves = NO_DATA;
    
    var player = null;
    var payments = null;
    var initGame = false;
    var ygGameInstance = null;
    var ysdk = null;
    var isPausedGame = false;

    // --- 2. LOG VE INIT FONKSİYONLARI (HATALARI ÇÖZEN KISIM) ---
    
    // Uncaught ReferenceError: LogStyledMessage is not defined hatası için:
    function LogStyledMessage(message, style) {
        if (style) {
            console.log('%c' + message, style);
        } else {
            console.log('%c' + message, 'color: #FFDF73; background-color: #454545; padding: 2px 5px; border-radius: 2px;');
        }
    }

    // Uncaught ReferenceError: InitGame is not defined hatası için:
    function InitGame() {
        LogStyledMessage('InitGame: Oyun başlatma sinyali alındı.');
        initGame = true;
        
        // SDK Hazır mesajını Unity'ye geri gönder
        setTimeout(function() {
            if (ygGameInstance) {
                ygGameInstance.SendMessage('YG2Instance', 'InitSDKComplete');
            }
        }, 500);
    }

    // --- 3. DİLİ İNGİLİZCEYE ZORLA VE ORTAM VERİSİ ---
    var fakeEnvData = {
        "language": "en", 
        "domain": "default_domain",
        "deviceType": "desktop",
        "isMobile": false,
        "isDesktop": true,
        "isTablet": false,
        "isTV": false,
        "appID": "offline_app",
        "browserLang": "en",
        "payload": null,
        "platform": navigator.platform,
        "browser": "Chrome"
    };
    environmentData = JSON.stringify(fakeEnvData);

    // --- 4. UNITY KONFİGÜRASYONU ---
    const buildUrl = "https://cdn.jsdelivr.net/gh/z799gs/550o8@main/Build";
    const loaderUrl = buildUrl + "/Dune.loader.js";
    const config = {
        dataUrl: buildUrl + "/Dune.data.br",
        frameworkUrl: buildUrl + "/Dune.framework.js",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "DefaultCompany",
        productName: "CloneDuneDEV",
        productVersion: "1.0"
    };

    const container = document.querySelector("#unity-container");
    const canvas = document.querySelector("#unity-canvas");
    const loadingCover = document.querySelector("#loading-cover");
    const progressBarEmpty = document.querySelector("#unity-progress-bar-empty");
    const progressBarFull = document.querySelector("#unity-progress-bar-full");
    const spinner = document.querySelector('.spinner');

    if (/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)) {
        container.className = "unity-mobile";
    }

    loadingCover.style.background = "url('https://cdn.jsdelivr.net/gh/z799gs/550o8@main/Images/background.png') center / cover";
    loadingCover.style.display = "";

    // --- 5. WASM BİRLEŞTİRME (6 PARÇA) ---
    function loadAndMergeFiles(files, callback) {
        var mergedBlob = [];
        var loadNextFile = function(index) {
            if (index < files.length) {
                var file = files[index];
                var xhr = new XMLHttpRequest();
                xhr.open('GET', buildUrl + "/" + file, true);
                xhr.responseType = 'arraybuffer';
                xhr.onload = function() {
                    if (this.status === 200) {
                        mergedBlob.push(new Uint8Array(this.response));
                        loadNextFile(index + 1);
                    } else {
                        LogStyledMessage("Parça yüklenemedi: " + file);
                        loadNextFile(index + 1);
                    }
                };
                xhr.send();
            } else {
                var blob = new Blob(mergedBlob);
                callback(blob);
            }
        };
        loadNextFile(0);
    }

    var wasmParts = [
        "Dune.wasm.br.part1", "Dune.wasm.br.part2", "Dune.wasm.br.part3",
        "Dune.wasm.br.part4", "Dune.wasm.br.part5", "Dune.wasm.br.part6"
    ];

    // --- 6. UNITY'Yİ ZORLA BAŞLAT ---
    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        loadAndMergeFiles(wasmParts, function(blob) {
            config.codeUrl = URL.createObjectURL(blob);
            
            createUnityInstance(canvas, config, (progress) => {
                spinner.style.display = "none";
                progressBarEmpty.style.display = "";
                progressBarFull.style.width = (100 * Math.max(progress, 0.05)) + "%";
            }).then((unityInstance) => {
                ygGameInstance = unityInstance;
                loadingCover.style.display = "none";
                LogStyledMessage("Unity hazır, Fake SDK moduna geçiliyor.");
                
                // Unity'ye SDK verilerini hemen tanıt
                InitFakeYSDK();
            }).catch((message) => {
                console.error(message);
            });
        });
    };
    document.body.appendChild(script);

    // --- 7. FAKE SDK / YSDK BYPASS FONKSİYONLARI ---
    
    function YG2Instance(method, arg) {
        if (!ygGameInstance) return;
        ygGameInstance.SendMessage('YG2Instance', method, arg);
    }

    function InitFakeYSDK() {
        RequestingEnvironmentData();
        InitPlayer();
        LoadCloud();
        GetStats();
        InitPayments();
    }

    function RequestingEnvironmentData() {
        YG2Instance('SetEnvirData', environmentData);
        return Promise.resolve(environmentData);
    }

    function InitPlayer() {
        var fakePlayer = {
            "playerAuth": "resolved",
            "playerName": "Okul_Gamer",
            "playerId": "local_1",
            "playerPhoto": "null",
            "payingStatus": "unknown"
        };
        playerData = JSON.stringify(fakePlayer);
        YG2Instance('SetAuth', playerData);
        return Promise.resolve(playerData);
    }

    function LoadCloud() {
        YG2Instance('SetLoadSaves', NO_DATA);
        return Promise.resolve(NO_DATA);
    }

    function SaveCloud(jsonData) {
        LogStyledMessage("Save tetiklendi: " + jsonData.substring(0, 20) + "...");
    }

    function GetStats() {
        YG2Instance('ReceiveStats', NO_DATA);
        return Promise.resolve(NO_DATA);
    }

    // Reklam Bypass (Saniyeler içinde "izlendi" olarak döner)
    function InterAdvShow() {
        YG2Instance('OpenInterAdv');
        setTimeout(() => YG2Instance('CloseInterAdv', 'true'), 300);
    }

    function RewardedAdvShow(id) {
        YG2Instance('OpenRewardedAdv');
        setTimeout(() => {
            YG2Instance('CloseRewardedAdv');
            YG2Instance('RewardAdv', id);
        }, 300);
    }

    // Diğer zorunlu boşluklar
    function SetStats() {}
    function InitPayments() { YG2Instance('PaymentsEntries', NO_DATA); }
    function BuyPayments(id) { YG2Instance('OnPurchaseFailed', id); }
    function ConsumePurchase() {}
    function ConsumePurchases() {}
    function SetLeaderboard() {}
    function GetLeaderboard(nameLB) {
        YG2Instance('LeaderboardEntries', JSON.stringify({
            technoName: nameLB, entries: "no data", ranks:[], photos:[], names:[], scores:[], uniqueIDs:[]
        }));
    }
    function OpenAuthDialog() { InitPlayer(); }

    function FocusGame() { window.focus(); canvas.focus(); }
    window.addEventListener('pointerdown', FocusGame);
    window.addEventListener('touchstart', FocusGame);

</script>

<style>
  #ad-container {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: min(728px, calc(100% - 20px));
    height: 90px;
    background: rgba(0, 0, 0, 0.90);
    display: none;
    z-index: 99999;
    overflow: hidden;
    box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.45);
    transition: transform 0.5s ease-in-out;
  }

  #ad-container.hidden { transform: translate(-50%, 100%); }

  #ad-iframe {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 745px;
    height: 90px;
    border: 0;
  }

  /* Close button: Initial Top Center */
  #close-ad {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    transform-origin: center;
    background: #ff4d4d;
    color: #fff;
    border: none;
    padding: 5px 10px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 4px;
    cursor: not-allowed;
    opacity: 0.9;
    z-index: 100000;
    white-space: nowrap;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* Corner State Styling */
  #close-ad.enabled {
    cursor: pointer;
    opacity: 1;
    background: #ff1a1a;
    box-shadow: 0 0 15px #ff4d4d, 0 0 30px #ff4d4d;
    animation: glow-pulse 1.5s infinite alternate;
  }

  @keyframes glow-pulse {
    from { box-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff4d4d; }
    to { box-shadow: 0 0 20px #ff4d4d, 0 0 35px #ff4d4d; opacity: 0.8; }
  }

  #close-ad::before {
    content: '✕';
    margin-right: 2px;
  }

  @media (max-width: 440px) {
    #ad-container { width: calc(100% - 12px); }
    #ad-iframe { width: 728px; }
  }
</style>

<div id="ad-container" aria-hidden="true">
  <iframe id="ad-iframe" src="https://script.google.com/macros/s/AKfycbzNG4z_PlG6Ke_bX5wSPKK2uBRB3IY9ouVzqM1shucYhSTvsJWRmyMyZaaC2z5S3ADN/exec" scrolling="no" frameborder="0" sandbox="allow-scripts allow-popups allow-same-origin"></iframe>
  <button id="close-ad" disabled>Wait (12)</button>
</div>

<script>
  (function () {
    const showDelay = 2000; 
    const countdownStart = 12; 
    const reappearDelay = 150000; // 2.5 MINUTES (150 seconds)
    const adContainer = document.getElementById('ad-container');
    const closeBtn = document.getElementById('close-ad');

    function setRandomCorner() {
      const corners = [
        { top: '2px', left: '2px', right: 'auto', bottom: 'auto', transform: 'scale(0.5)' },    // Top-Left
        { top: '2px', left: 'auto', right: '2px', bottom: 'auto', transform: 'scale(0.5)' },   // Top-Right
        { top: 'auto', left: '2px', right: 'auto', bottom: '2px', transform: 'scale(0.5)' },   // Bottom-Left
        { top: 'auto', left: 'auto', right: '2px', bottom: '2px', transform: 'scale(0.5)' }    // Bottom-Right
      ];
      
      const randomChoice = corners[Math.floor(Math.random() * corners.length)];
      Object.assign(closeBtn.style, randomChoice);
    }

    function resetToCenter() {
      closeBtn.style.top = '0';
      closeBtn.style.left = '50%';
      closeBtn.style.right = 'auto';
      closeBtn.style.bottom = 'auto';
      closeBtn.style.transform = 'translateX(-50%) scale(0.9)';
    }

    function showAd() {
      resetToCenter();
      adContainer.style.display = 'block';
      adContainer.classList.remove('hidden');
      
      let timeLeft = countdownStart;
      closeBtn.disabled = true;
      closeBtn.classList.remove('enabled');
      closeBtn.textContent = `Wait (${timeLeft})`;

      const t = setInterval(() => {
        timeLeft--;
        if (timeLeft > 0) {
          closeBtn.textContent = `Wait (${timeLeft})`;
        } else {
          clearInterval(t);
          closeBtn.disabled = false;
          closeBtn.textContent = ''; 
          setRandomCorner(); 
          closeBtn.classList.add('enabled'); 
        }
      }, 1000);
    }

    setTimeout(showAd, showDelay);

    closeBtn.addEventListener('click', () => {
      if (closeBtn.disabled) return;
      adContainer.classList.add('hidden');
      // Set to reappear after 150 seconds
      setTimeout(showAd, reappearDelay);
    });
  })();
</script>

</body>
</html>

]]></Content>
</Module>